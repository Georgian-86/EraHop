<section class="gallery-section">
    <div class="gallery-header">
        <h2 class="section-title">Time Travel Gallery</h2>
        <p class="gallery-description">Journey through time with our stunning collection of moments across eras</p>
        
        {{#if showUploadButton}}
        <div class="admin-controls">
            <button class="add-image-btn" onclick="openUploadModal()">
                <i class="fas fa-plus"></i> Add New Image
            </button>
        </div>
        {{/if}}
    </div>

    <div class="gallery-filters">
        <button class="filter-btn active" data-filter="all">
            <i class="fas fa-globe"></i>
            <span>All Eras</span>
        </button>
        <button class="filter-btn" data-filter="prehistoric">
            <i class="fas fa-mountain"></i>
            <span>Prehistoric</span>
        </button>
        <button class="filter-btn" data-filter="medieval">
            <i class="fas fa-chess-rook"></i>
            <span>Medieval</span>
        </button>
        <button class="filter-btn" data-filter="future">
            <i class="fas fa-robot"></i>
            <span>Future</span>
        </button>
    </div>

    <div class="gallery-grid">
        {{#each items}}
        <div class="gallery-item {{this.era}}" data-aos="fade-up">
            <img src="{{this.imageUrl}}" alt="{{this.title}}">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge {{this.era}}">{{this.era}}</span>
                    <h3>{{this.title}}</h3>
                    <p>{{this.description}}</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>
        {{/each}}

        <!-- Default Gallery Items -->
        <div class="gallery-item prehistoric" data-aos="fade-up">
            <img src="/images/gallery/prehistoric/dino1.jpg" alt="Dinosaur Safari">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge prehistoric">Prehistoric</span>
                    <h3>Jurassic Experience</h3>
                    <p>Live dinosaur encounters in their natural habitat</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <div class="gallery-item prehistoric" data-aos="fade-up">
            <img src="/images/gallery/prehistoric/excavation.jpg" alt="Fossil Excavation">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge prehistoric">Prehistoric</span>
                    <h3>Fossil Discovery</h3>
                    <p>Unearth ancient mysteries at our excavation sites</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <div class="gallery-item medieval" data-aos="fade-up">
            <img src="/images/gallery/medieval/tournament.jpg" alt="Knights Tournament">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge medieval">Medieval</span>
                    <h3>Knights Tournament</h3>
                    <p>Epic jousting matches at the grand arena</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <div class="gallery-item medieval" data-aos="fade-up">
            <img src="/images/gallery/medieval/feast.jpg" alt="Royal Feast">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge medieval">Medieval</span>
                    <h3>Royal Banquet</h3>
                    <p>Experience authentic medieval cuisine and entertainment</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <div class="gallery-item future" data-aos="fade-up">
            <img src="/images/gallery/future/hologram.jpg" alt="Holographic Display">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge future">Future</span>
                    <h3>Holographic Concert</h3>
                    <p>Next-generation entertainment with AI performers</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <div class="gallery-item future" data-aos="fade-up">
            <img src="/images/gallery/future/space.jpg" alt="Space Simulator">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge future">Future</span>
                    <h3>Space Flight</h3>
                    <p>Zero-gravity simulation experience</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <!-- Additional Cards -->
        <div class="gallery-item prehistoric" data-aos="fade-up">
            <img src="/images/gallery/prehistoric/cave-art.jpg" alt="Cave Art Workshop">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge prehistoric">Prehistoric</span>
                    <h3>Cave Art Workshop</h3>
                    <p>Create authentic prehistoric cave paintings using ancient techniques</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <div class="gallery-item medieval" data-aos="fade-up">
            <img src="/images/gallery/medieval/archery.jpg" alt="Medieval Archery">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge medieval">Medieval</span>
                    <h3>Archery Training</h3>
                    <p>Master the art of medieval archery with expert instructors</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>

        <div class="gallery-item future" data-aos="fade-up">
            <img src="/images/gallery/future/quantum-lab.jpg" alt="Quantum Computing">
            <div class="item-overlay">
                <div class="item-content">
                    <span class="era-badge future">Future</span>
                    <h3>Quantum Lab</h3>
                    <p>Experience the power of next-generation quantum computing</p>
                    <button class="view-btn" onclick="openGalleryModal(this)">
                        <i class="fas fa-expand"></i> View
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Gallery Modal -->
    <div class="gallery-modal" id="galleryModal">
        <button class="close-modal">&times;</button>
        <button class="nav-btn prev-btn"><i class="fas fa-chevron-left"></i></button>
        <button class="nav-btn next-btn"><i class="fas fa-chevron-right"></i></button>
        <div class="modal-content">
            <img src="" alt="" id="modalImage">
            <div class="modal-info">
                <h3 id="modalTitle"></h3>
                <p id="modalDescription"></p>
                <span id="modalEra"></span>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeUploadModal()">&times;</span>
            <h3>Upload New Image</h3>
            <form id="galleryUploadForm" class="upload-form">
                <div class="form-group">
                    <label for="title">Title:</label>
                    <input type="text" id="title" name="title" required>
                </div>
                <div class="form-group">
                    <label for="description">Description:</label>
                    <textarea id="description" name="description" required></textarea>
                </div>
                <div class="form-group">
                    <label for="era">Era:</label>
                    <select id="era" name="era" required>
                        <option value="prehistoric">Prehistoric</option>
                        <option value="medieval">Medieval</option>
                        <option value="future">Future</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="image">Image:</label>
                    <input type="file" id="image" name="image" accept="image/*" required>
                </div>
                <button type="submit" class="upload-btn">Upload</button>
            </form>
        </div>
    </div>
</section>

<script>
function openUploadModal() {
    document.getElementById('uploadModal').style.display = 'block';
}

function closeUploadModal() {
    document.getElementById('uploadModal').style.display = 'none';
}

document.getElementById('galleryUploadForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData();
    formData.append('title', document.getElementById('title').value);
    formData.append('description', document.getElementById('description').value);
    formData.append('era', document.getElementById('era').value);
    formData.append('image', document.getElementById('image').files[0]);

    try {
        const response = await fetch('/interactive/gallery/upload', {
            method: 'POST',
            body: formData
        });

        const data = await response.json();
        
        if (response.ok) {
            alert('Upload successful!');
            location.reload();
        } else {
            throw new Error(data.message);
        }
    } catch (error) {
        alert('Upload failed: ' + error.message);
    }
});

// Close modal when clicking outside
window.onclick = function(event) {
    const modal = document.getElementById('uploadModal');
    if (event.target == modal) {
        modal.style.display = "none";
    }
}
</script>

<style>
/* Add to your existing gallery styles */
.admin-controls {
    margin: 2rem 0;
    text-align: center;
}

.add-image-btn {
    background: #4CAF50;
    color: white;
    padding: 0.8rem 1.5rem;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-size: 1rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: background 0.3s ease;
}

.add-image-btn:hover {
    background: #45a049;
}

.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 1000;
}

.modal-content {
    background: #fff;
    margin: 10% auto;
    padding: 2rem;
    border-radius: 8px;
    max-width: 500px;
    position: relative;
}

.close-modal {
    position: absolute;
    right: 1rem;
    top: 0.5rem;
    font-size: 1.5rem;
    cursor: pointer;
}

.upload-form {
    margin-top: 1rem;
}

.form-group {
    margin-bottom: 1rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    color: #333;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.upload-btn {
    background: #4CAF50;
    color: white;
    padding: 0.8rem 1.5rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
}

.upload-btn:hover {
    background: #45a049;
}
</style> 